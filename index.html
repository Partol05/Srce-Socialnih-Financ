<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Srce Socialnih Financ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .water-drop {
            width: 40px;
            height: 50px;
            background: linear-gradient(135deg, #4ade80 0%, #16a34a 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
        }

        .water-drop::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            width: 12px;
            height: 15px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
        }

        .app-title {
            font-size: 18px;
            font-weight: bold;
            line-height: 1.2;
        }

        .content {
            padding: 20px;
        }

        .main-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .option-card {
            padding: 20px;
            border-radius: 15px;
            color: white;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            width: 100%;
        }

        .option-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .option-1 {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        }

        .option-2 {
            background: linear-gradient(135deg, #10b981 0%, #047857 100%);
        }

        .option-3 {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #374151;
        }

        .form-group input, 
        .form-group select, 
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .back-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            font-weight: bold;
        }

        .simulator {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .simulator-result {
            font-size: 18px;
            font-weight: bold;
            color: #1d4ed8;
            text-align: center;
            margin-top: 10px;
        }

        .tracking-section {
            display: none;
        }

        .tracking-section.active {
            display: block;
        }

        .dashboard {
            background: #f8fafc;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-approved {
            background: #d1fae5;
            color: #065f46;
        }

        .status-rejected {
            background: #fee2e2;
            color: #991b1b;
        }

        .message-box {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .testimonial {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border-left: 4px solid #3b82f6;
        }

        .testimonial-author {
            font-weight: bold;
            color: #374151;
            margin-bottom: 5px;
        }

        .testimonial-date {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 10px;
        }

        .testimonial-text {
            color: #4b5563;
            line-height: 1.5;
        }

        .admin-panel {
            display: none;
        }

        .admin-panel.active {
            display: block;
        }

        .admin-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border: 2px solid #e5e7eb;
        }

        .admin-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .approve-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
        }

        .reject-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            flex: 1;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #10b981;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            z-index: 1000;
            display: none;
        }

        .hidden {
            display: none;
        }

        .file-input {
            border: 2px dashed #d1d5db;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .file-input:hover {
            border-color: #3b82f6;
        }

        .file-input.dragover {
            border-color: #3b82f6;
            background-color: #f0f9ff;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .logout-btn:hover {
            background: #dc2626 !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }

        .user-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .admin-logout {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        @media (max-width: 480px) {
            .container {
                margin: 0;
                border-radius: 0;
                min-height: 100vh;
            }

            body {
                padding: 0;
            }
        }
        /* SÃ©lecteur de langues */
.language-selector {
    position: absolute;
    top: 15px;
    right: 15px;
    z-index: 1000;
}

.language-dropdown {
    position: relative;
    display: inline-block;
}

.language-btn {
    background: rgba(255, 255, 255, 0.9);
    border: 2px solid rgba(139, 69, 19, 0.3);
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 600;
    color: #8B4513;
    transition: all 0.3s ease;
    min-width: 120px;
    justify-content: space-between;
}

.language-btn:hover {
    background: white;
    border-color: #8B4513;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.language-dropdown-content {
    display: none;
    position: absolute;
    top: 100%;
    right: 0;
    background: white;
    min-width: 160px;
    border-radius: 8px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    border: 1px solid #e5e7eb;
    z-index: 1001;
}

.language-dropdown.active .language-dropdown-content {
    display: block;
}

.language-option {
    padding: 12px 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 14px;
    transition: background-color 0.2s;
    border-bottom: 1px solid #f3f4f6;
}

.language-option:last-child {
    border-bottom: none;
}

.language-option:hover {
    background-color: #f8fafc;
}

.language-option.active {
    background-color: #eff6ff;
    color: #1d4ed8;
    font-weight: 600;
}

.flag {
    font-size: 18px;
    width: 24px;
    text-align: center;
}

.dropdown-arrow {
    transition: transform 0.3s ease;
}

.language-dropdown.active .dropdown-arrow {
    transform: rotate(180deg);
}
    </style>
</head>
<body>
    <div class="container">
       <div class="header">
    <!-- SÃ©lecteur de langues -->
    <div class="language-selector">
        <div class="language-dropdown" id="languageDropdown">
            <button class="language-btn" onclick="toggleLanguageDropdown()">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <span class="flag" id="currentFlag">ð¸ð®</span>
                    <span id="currentLang">SlovenÅ¡Äina</span>
                </div>
                <span class="dropdown-arrow">â¼</span>
            </button>
            <div class="language-dropdown-content">
                <div class="language-option active" onclick="changeLanguage('sl')">
                    <span class="flag">ð¸ð®</span>
                    <span>SlovenÅ¡Äina</span>
                </div>
                <div class="language-option" onclick="changeLanguage('es')">
                    <span class="flag">ðªð¸</span>
                    <span>EspaÃ±ol</span>
                </div>
                <div class="language-option" onclick="changeLanguage('hr')">
                    <span class="flag">ð­ð·</span>
                    <span>Hrvatski</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="logo-section">
        <div class="water-drop"></div>
        <div class="app-title">Srce Socialnih Financ</div>
    </div>
    <div style="font-size: 14px; margin-top: 10px; opacity: 0.9; font-style: italic;">
        VaÅ¡ zanesljiv partner za finanÄne reÅ¡itve
    </div>
</div>

        <!-- Page d'accueil -->
        <div id="home" class="content">
            <div class="main-options">
    <button class="option-card option-1" onclick="showSection('credit-form')">
        ð Zahteva za kredit
        <div style="font-size: 12px; margin-top: 5px;">VloÅ¾ite vaÅ¡o kreditno vlogo</div>
    </button>
    <button class="option-card option-2" onclick="showSection('tracking')">
        ð Spremljanje vloge
        <div style="font-size: 12px; margin-top: 5px;">Preverite status vaÅ¡e vloge</div>
    </button>
    <button class="option-card option-3" onclick="showSection('testimonials')">
        â­ PriÄevanja
        <div style="font-size: 12px; margin-top: 5px;">IzkuÅ¡nje naÅ¡ih strank</div>
    </button>
</div>
        </div>

        <!-- Formulaire de crÃ©dit -->
        <div id="credit-form" class="form-section content">
            <button class="back-btn" onclick="showSection('home')">â Nazaj</button>
            <h2 style="margin-bottom: 20px; color: #1f2937;">Zahteva za kredit</h2>
            
            <form id="creditForm">
                <div class="form-group">
                    <label>Ime *</label>
                    <input type="text" id="firstName" required>
                </div>
                
                <div class="form-group">
    <label>Priimek *</label>
    <input type="text" id="lastName" required>
</div>

<div class="form-group">
    <label>E-poÅ¡ta *</label>
    <input type="email" id="email" required placeholder="ime@example.com">
</div>

<div class="form-group">
    <label>DrÅ¾ava *</label>
    <select id="country" required>
        <option value="">Izberite drÅ¾avo</option>
        <option value="Slovenia">Slovenija</option>
        <option value="Croatia">HrvaÅ¡ka</option>
        <option value="Austria">Avstrija</option>
        <option value="Italy">Italija</option>
    </select>
</div>
                
                <div class="form-group">
                    <label>Mesto *</label>
                    <input type="text" id="city" required>
                </div>
                
                <div class="form-group">
                    <label>Polni naslov *</label>
                    <textarea id="address" rows="3" required></textarea>
                </div>
                
                <div class="form-group">
                    <label>Znesek kredita (â¬) *</label>
                    <input type="number" id="amount" min="500" max="50000" required oninput="calculateLoan()">
                </div>
                
                <div class="form-group">
                    <label>Meseci vraÄanja (1-120) *</label>
                    <input type="number" id="months" min="1" max="120" required oninput="calculateLoan()">
                </div>
                
                <div class="form-group">
                    <label>MeseÄni dohodek (â¬) *</label>
                    <input type="number" id="income" required>
                </div>

                <div class="simulator">
                    <h4 style="margin-bottom: 10px;">Simulator kredita (3% obrestna mera)</h4>
                    <div id="simulatorResult" class="simulator-result">
                        Vnesite znesek in mesece za izraÄun
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Osebni dokument</label>
                    <div class="file-input" onclick="document.getElementById('idDocument').click()">
                        <input type="file" id="idDocument" style="display: none;" accept="image/*,.pdf">
                        <div>ð Kliknite za izbiro datoteke</div>
                        <div style="font-size: 12px; margin-top: 5px;">PDF ali slika</div>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn">PoÅ¡ljite vlogo</button>
            </form>

            <div id="submitLoading" class="loading">
                <div class="spinner"></div>
                <div>PoÅ¡iljanje vloge...</div>
            </div>
        </div>

        <!-- Suivi de dossier -->
        <div id="tracking" class="tracking-section content">
            <button class="back-btn" onclick="showSection('home')">â Nazaj</button>
            <h2 style="margin-bottom: 20px; color: #1f2937;">Spremljanje vloge</h2>
            
            <div class="form-group">
                <label>Vnesite Å¡tevilko sledenja</label>
                <input type="text" id="trackingNumber" placeholder="KR-2025-001">
            </div>
            <button onclick="checkTracking()" class="submit-btn">Preveri status</button>

            <div id="trackingLoading" class="loading">
                <div class="spinner"></div>
                <div>Preverjanje statusa...</div>
            </div>

            <div id="userDashboard" class="dashboard hidden">
                <div id="applicationStatus"></div>
                <div class="message-box">
                    <h4>SporoÄila</h4>
                    <div id="userMessages"></div>
                    <textarea id="userMessageText" placeholder="NapiÅ¡ite sporoÄilo..." rows="3" style="width: 100%; margin: 10px 0;"></textarea>
                    <button onclick="sendUserMessage()" class="submit-btn" style="padding: 8px;">PoÅ¡lji sporoÄilo</button>
                </div>
            </div>
        </div>

        <!-- Panel administrateur -->
        <div id="admin-panel" class="admin-panel content">
            <button class="back-btn" onclick="showSection('home')">â Nazaj</button>
            <h2 style="margin-bottom: 20px; color: #1f2937;">Administratorski panel</h2>
            
            <div id="adminLoading" class="loading">
                <div class="spinner"></div>
                <div>Nalaganje vlog...</div>
            </div>
            
            <div id="adminApplications"></div>
        </div>

        <!-- TÃ©moignages -->
        <div id="testimonials" class="form-section content">
            <button class="back-btn" onclick="showSection('home')">â Nazaj</button>
            <h2 style="margin-bottom: 20px; color: #1f2937;">PriÄevanja strank</h2>
            
            <div id="testimonialsContainer"></div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Configuration de l'API
        const API_BASE_URL = window.location.hostname === 'localhost' ? 
            'http://localhost:3000/api' : 
            'https://srce-socialnih-financ.onrender.com/api';

        // Variables globales
        let currentUser = null;

        // TÃ©moignages
        const testimonials = [
            {
                name: "Marija Novak",
                date: "Januar 2025",
                text: "OdliÄen servis! Kredit sem dobila v samo 3 dneh. Postopek je bil preprost in transparenten."
            },
            {
                name: "Janez Horvat",
                date: "December 2024",
                text: "Zelo zadovoljen s hitrostjo odobravanja. Potreboval sem kredit za dom in ga dobil brez zapletov."
            },
            {
                name: "Ana Kranjc",
                date: "November 2024",
                text: "Prijazno osebje in konkurenÄne obrestne mere. PriporoÄam vsem!"
            },
            {
                name: "Matej Å½agar",
                date: "Oktober 2024",
                text: "Transparentni pogoji in hitra obravnava. Kredit sem uporabil za renovacijo stanovanja."
            },
            {
                name: "Petra Kos",
                date: "September 2024",
                text: "Izvrstna izkuÅ¡nja! Online postopek je zelo uporaben in enostaven."
            },
            {
                name: "Luka Mlakar",
                date: "Avgust 2024",
                text: "Potreboval sem kredit za avto. Proces je bil hiter in brez skritih stroÅ¡kov."
            },
            {
                name: "Eva Rebec",
                date: "Julij 2024",
                text: "OdliÄna komunikacija in podpora. Vse je bilo jasno razloÅ¾eno."
            },
            {
                name: "TomaÅ¾ Vidmar",
                date: "Junij 2024",
                text: "Kredit sem dobil za Å¡tudij. Ugodne obrestne mere in fleksibilni pogoji."
            },
            {
                name: "Maja Bizjak",
                date: "Maj 2024",
                text: "Zelo zadovoljna s storitvijo. Hitro in zanesljivo."
            },
            {
                name: "Rok Petek",
                date: "April 2024",
                text: "Profesionalen pristop in odliÄen servis. PriporoÄam!"
            },
            {
                name: "Katja Zupan",
                date: "Marec 2023",
                text: "Kredit za podjetje sem dobila brez teÅ¾av. OdliÄen partner za financiranje."
            },
            {
                name: "Miha Kastelic",
                date: "Februar 2023",
                text: "Potreboval sem kredit za zdravljenje. Dobil sem ga hitro in po ugodni ceni."
            },
            {
                name: "Tanja Golob",
                date: "Januar 2023",
                text: "Izvrstna izkuÅ¡nja! Kredit sem dobila v rekordnem Äasu."
            },
            {
                name: "David Lakner",
                date: "December 2022",
                text: "Ugodne obrestne mere in hiter postopek. Zelo priporoÄam!"
            },
            {
                name: "Nina Cerar",
                date: "November 2022",
                text: "Prijazno osebje in transparentni pogoji. Popolnoma zadovoljna!"
            }
        ];

        // Fonctions API
        async function apiCall(endpoint, method = 'GET', data = null) {
            try {
                const options = {
                    method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };

                if (data) {
                    options.body = JSON.stringify(data);
                }

                const response = await fetch(`${API_BASE_URL}${endpoint}`, options);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API call failed:', error);
                showNotification('Napaka pri povezavi s streÅ¾nikom', 'error');
                throw error;
            }
        }

        // Soumission du formulaire
        document.getElementById('creditForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Afficher le loading
            document.getElementById('submitLoading').style.display = 'block';
            document.getElementById('creditForm').style.display = 'none';
            
            try {
               const formData = {
    firstName: document.getElementById('firstName').value,
    lastName: document.getElementById('lastName').value,
    email: document.getElementById('email').value,               
    country: document.getElementById('country').value,
    city: document.getElementById('city').value,
    address: document.getElementById('address').value,
    amount: parseFloat(document.getElementById('amount').value),
    months: parseInt(document.getElementById('months').value),
    income: parseFloat(document.getElementById('income').value)
};

                const result = await apiCall('/applications', 'POST', formData);
                
                // Afficher une alerte persistante avec le code
                alert(`â VLOGA USPEÅ NO POSLANA!\n\nð Å TEVILKA SLEDENJA:\n${result.applicationId}\n\nâ ï¸ POMEMBNO: Shranite to Å¡tevilko za spremljanje vaÅ¡e vloge!`);
                
                showNotification(`Vloga uspeÅ¡no poslana! Å tevilka: ${result.applicationId}`, 'success', 10000);
                
                // Reset formulaire
                document.getElementById('creditForm').reset();
                document.getElementById('simulatorResult').innerHTML = 'Vnesite znesek in mesece za izraÄun';
                
                setTimeout(() => {
                    showSection('home');
                }, 5000);
                
            } catch (error) {
                showNotification('Napaka pri poÅ¡iljanju vloge. Poskusite znova.', 'error');
            } finally {
                document.getElementById('submitLoading').style.display = 'none';
                document.getElementById('creditForm').style.display = 'block';
            }
        });

        // Suivi des demandes
        async function checkTracking() {
            const trackingNumber = document.getElementById('trackingNumber').value.trim();
            
            if (!trackingNumber) {
                showNotification('Vnesite Å¡tevilko sledenja', 'error');
                return;
            }

            document.getElementById('trackingLoading').style.display = 'block';
            
            try {
                if (trackingNumber === 'ADMINX2025') {
                    await showAdminPanel();
                } else {
                    const application = await apiCall(`/applications/${trackingNumber}`);
                    currentUser = trackingNumber;
                    showUserDashboard(application);
                }
            } catch (error) {
                showNotification('Å tevilka sledenja ni najdena!', 'error');
            } finally {
                document.getElementById('trackingLoading').style.display = 'none';
            }
        }

       // Tableau de bord utilisateur
function showUserDashboard(application) {
    const dashboard = document.getElementById('userDashboard');
    dashboard.classList.remove('hidden');
    
    const statusColors = {
        pending: 'status-pending',
        approved: 'status-approved',
        rejected: 'status-rejected'
    };
    
    const statusTexts = {
        pending: 'V obravnavi',
        approved: 'Odobreno',
        rejected: 'Zavrnjeno'
    };
    
    // Calculer les dÃ©tails du crÃ©dit
    const amount = application.amount;
    const months = application.months;
    const rate = 0.03; // 3% annuel
    const monthlyRate = rate / 12;
    const monthlyPayment = amount * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
    const total = monthlyPayment * months;
    const interest = total - amount;
    
    document.getElementById('applicationStatus').innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0;">VaÅ¡a kreditna vloga</h3>
            <button onclick="logoutUser()" style="background: #ef4444; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-size: 12px;">
                ðª Odjava
            </button>
        </div>
        
        <!-- Status -->
        <div style="margin-bottom: 20px; text-align: center;">
            <div class="status-badge ${statusColors[application.status]}" style="font-size: 14px; padding: 10px 20px;">
                ${statusTexts[application.status]}
            </div>
            <div style="font-size: 13px; color: #6b7280; margin-top: 10px;">Å tevilka vloge: <strong>${application.applicationId}</strong></div>
            <div style="font-size: 13px; color: #6b7280;">Datum vloge: <strong>${new Date(application.createdAt).toLocaleDateString('sl-SI')}</strong></div>
        </div>

        <!-- Osebni podatki -->
        <div style="background: white; padding: 15px; border-radius: 10px; margin: 15px 0; border: 2px solid #e5e7eb;">
            <h4 style="margin: 0 0 12px 0; color: #374151; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px;">ð¤ Osebni podatki</h4>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">Ime:</span>
                <span style="font-weight: 600;">${application.firstName}</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">Priimek:</span>
                <span style="font-weight: 600;">${application.lastName}</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">E-poÅ¡ta:</span>
                <span style="font-weight: 600;">${application.email || 'Ni navedeno'}</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">DrÅ¾ava:</span>
                <span style="font-weight: 600;">${application.country}</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">Mesto:</span>
                <span style="font-weight: 600;">${application.city}</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0;">
                <div style="color: #6b7280; margin-bottom: 4px;">Naslov:</div>
                <div style="font-weight: 600; background: #f9fafb; padding: 8px; border-radius: 5px;">${application.address}</div>
            </div>
        </div>

        <!-- Podatki o kreditu -->
        <div style="background: white; padding: 15px; border-radius: 10px; margin: 15px 0; border: 2px solid #e5e7eb;">
            <h4 style="margin: 0 0 12px 0; color: #374151; border-bottom: 1px solid #e5e7eb; padding-bottom: 8px;">ð° Podatki o kreditu</h4>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">Zahtevani znesek:</span>
                <span style="font-weight: 600; color: #059669;">${amount.toLocaleString()}â¬</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">Obdobje vraÄanja:</span>
                <span style="font-weight: 600;">${months} mesecev</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">VaÅ¡ meseÄni dohodek:</span>
                <span style="font-weight: 600;">${application.income.toLocaleString()}â¬</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #6b7280;">Obrestna mera:</span>
                <span style="font-weight: 600; color: #3b82f6;">3% letno</span>
            </div>
        </div>

        <!-- Kalkulacija -->
        <div style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); padding: 15px; border-radius: 10px; margin: 15px 0; border: 2px solid #3b82f6;">
            <h4 style="margin: 0 0 12px 0; color: #1d4ed8; border-bottom: 1px solid rgba(59, 130, 246, 0.3); padding-bottom: 8px;">ð Kalkulacija vraÄanja</h4>
            <div style="font-size: 15px; margin: 10px 0; display: flex; justify-content: space-between; background: rgba(255,255,255,0.7); padding: 8px; border-radius: 5px;">
                <span style="color: #1e40af;">MeseÄna rata:</span>
                <span style="font-weight: bold; color: #1d4ed8;">${monthlyPayment.toFixed(2)}â¬</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #374151;">Skupaj za vrnitev:</span>
                <span style="font-weight: 600;">${total.toFixed(2)}â¬</span>
            </div>
            <div style="font-size: 14px; margin: 8px 0; display: flex; justify-content: space-between;">
                <span style="color: #374151;">Skupne obresti:</span>
                <span style="font-weight: 600; color: #dc2626;">${interest.toFixed(2)}â¬</span>
            </div>
        </div>
    `;
    
    loadUserMessages();
}

        // Panel administrateur
        async function showAdminPanel() {
            showSection('admin-panel');
            document.getElementById('adminLoading').style.display = 'block';
            
            // Ajouter le bouton de dÃ©connexion dans le header du panel admin
            const adminHeader = document.querySelector('#admin-panel h2');
            if (adminHeader && !adminHeader.querySelector('.logout-btn')) {
                const logoutBtn = document.createElement('button');
                logoutBtn.className = 'logout-btn';
                logoutBtn.innerHTML = 'ðª Odjava';
                logoutBtn.style.cssText = 'float: right; background: #ef4444; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 14px; margin-left: 10px;';
                logoutBtn.onclick = logoutAdmin;
                adminHeader.appendChild(logoutBtn);
            }
            
            // DÃ©marrer l'auto-actualisation
            startAdminAutoRefresh();
            
            try {
                const applications = await apiCall('/admin/applications');
                loadAdminApplications(applications);
            } catch (error) {
                showNotification('Napaka pri nalaganju vlog', 'error');
            } finally {
                document.getElementById('adminLoading').style.display = 'none';
            }
        }

        function loadAdminApplications(applications) {
            const container = document.getElementById('adminApplications');
            container.innerHTML = '';
            
            if (applications.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #6b7280;">Ni vlog</div>';
                return;
            }
            
            applications.forEach(async (app) => {
                const statusTexts = {
                    pending: 'V obravnavi',
                    approved: 'Odobreno',
                    rejected: 'Zavrnjeno'
                };
                
                // RÃ©cupÃ©rer le nombre de messages pour cette application
                let messageCount = 0;
                try {
                    const messages = await apiCall(`/applications/${app.applicationId}/messages`);
                    messageCount = messages.length;
                } catch (error) {
                    console.error('Erreur rÃ©cupÃ©ration messages:', error);
                }
                
                const card = document.createElement('div');
                card.className = 'admin-card';
                card.innerHTML = `
                    <div><strong>${app.firstName} ${app.lastName}</strong></div>
                    <div>Vloga: ${app.applicationId}</div>
                    <div>Znesek: ${app.amount}â¬ / ${app.months} mesecev</div>
                    <div>Dohodek: ${app.income}â¬/mesec</div>
                    <div>Status: <span class="status-badge status-${app.status}">${statusTexts[app.status]}</span></div>
                    <div>Datum: ${new Date(app.createdAt).toLocaleDateString('sl-SI')}</div>
                    <div style="margin: 10px 0;">
                        <strong>ð¬ SporoÄila (${messageCount})</strong>
                        <div id="adminMessages-${app.applicationId}" style="max-height: 200px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 5px 0;"></div>
                        <button onclick="toggleMessages('${app.applicationId}')" style="background: #6b7280; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; margin-bottom: 10px;">
                            PrikaÅ¾i/Skrij sporoÄila
                        </button>
                    </div>
                    <div class="admin-buttons">
                        <button class="approve-btn" onclick="updateApplicationStatus('${app.applicationId}', 'approved')">Odobri</button>
                        <button class="reject-btn" onclick="updateApplicationStatus('${app.applicationId}', 'rejected')">Zavrni</button>
                    </div>
                    <div style="margin-top: 10px;">
                        <textarea placeholder="SporoÄilo stranki..." id="adminMessage-${app.applicationId}" rows="2" style="width: 100%; margin-bottom: 5px;"></textarea>
                        <button onclick="sendAdminMessage('${app.applicationId}')" style="background: #3b82f6; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">PoÅ¡lji sporoÄilo</button>
                    </div>
                `;
                container.appendChild(card);
                
                // Charger les messages pour cette application
                loadAdminMessages(app.applicationId);
            });
        }

        // Mise Ã  jour du statut
        async function updateApplicationStatus(applicationId, status) {
            try {
                await apiCall(`/admin/applications/${applicationId}/status`, 'PUT', { status });
                const statusText = status === 'approved' ? 'odobrena' : 'zavrnjena';
                showNotification(`Vloga ${applicationId} ${statusText}!`);
                showAdminPanel(); // Refresh the list
            } catch (error) {
                showNotification('Napaka pri posodabljanju statusa', 'error');
            }
        }

        // Messages
        async function sendAdminMessage(applicationId) {
            const messageText = document.getElementById(`adminMessage-${applicationId}`).value;
            const sendButton = event.target;
            
            if (!messageText.trim()) {
                showNotification('Vnesite sporoÄilo', 'error');
                return;
            }
            
            // DÃ©sactiver le bouton
            sendButton.disabled = true;
            sendButton.textContent = 'PoÅ¡iljam...';
            sendButton.style.opacity = '0.6';
            
            try {
                await apiCall(`/admin/applications/${applicationId}/messages`, 'POST', {
                    message: messageText,
                    from: 'admin'
                });
                
                // Vider le champ
                document.getElementById(`adminMessage-${applicationId}`).value = '';
                
                // Notification de succÃ¨s
                showNotification('â SporoÄilo uspeÅ¡no poslano!', 'success', 4000);
                
            } catch (error) {
                showNotification('â Napaka pri poÅ¡iljanju sporoÄila', 'error', 5000);
            } finally {
                // RÃ©activer le bouton
                sendButton.disabled = false;
                sendButton.textContent = 'PoÅ¡lji sporoÄilo';
                sendButton.style.opacity = '1';
            }
        }

        async function sendUserMessage() {
            const messageText = document.getElementById('userMessageText').value;
            const sendButton = event.target;
            
            if (!messageText.trim()) {
                showNotification('Vnesite sporoÄilo', 'error');
                return;
            }
            
            if (!currentUser) {
                showNotification('Napaka: ni uporabnika', 'error');
                return;
            }
            
            // DÃ©sactiver le bouton et changer le texte
            sendButton.disabled = true;
            sendButton.textContent = 'PoÅ¡iljam...';
            sendButton.style.opacity = '0.6';
            
            try {
                await apiCall(`/applications/${currentUser}/messages`, 'POST', {
                    message: messageText,
                    from: 'user'
                });
                
                // Vider le champ de texte
                document.getElementById('userMessageText').value = '';
                
                // Recharger les messages
                await loadUserMessages();
                
                // Notification de succÃ¨s
                showNotification('â SporoÄilo uspeÅ¡no poslano!', 'success', 4000);
                
            } catch (error) {
                showNotification('â Napaka pri poÅ¡iljanju sporoÄila. Poskusite znova.', 'error', 5000);
            } finally {
                // RÃ©activer le bouton
                sendButton.disabled = false;
                sendButton.textContent = 'PoÅ¡lji sporoÄilo';
                sendButton.style.opacity = '1';
            }
        }

        async function loadUserMessages() {
            if (!currentUser) return;
            
            try {
                const messages = await apiCall(`/applications/${currentUser}/messages`);
                const container = document.getElementById('userMessages');
                
                if (messages.length === 0) {
                    container.innerHTML = '<div style="color: #6b7280;">Ni sporoÄil</div>';
                    return;
                }
                
                container.innerHTML = messages.map(msg => `
                    <div style="margin: 10px 0; padding: 10px; background: ${msg.from === 'admin' ? '#e0f2fe' : '#f3f4f6'}; border-radius: 8px;">
                        <div style="font-size: 12px; color: #6b7280; margin-bottom: 5px;">
                            ${msg.from === 'admin' ? 'Administrator' : 'Vi'} - ${new Date(msg.createdAt).toLocaleString('sl-SI')}
                        </div>
                        <div>${msg.message}</div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        // Fonction pour charger les messages dans le panel admin
        async function loadAdminMessages(applicationId) {
            try {
                const messages = await apiCall(`/applications/${applicationId}/messages`);
                const container = document.getElementById(`adminMessages-${applicationId}`);
                
                if (!container) return;
                
                if (messages.length === 0) {
                    container.innerHTML = '<div style="color: #6b7280; font-style: italic;">Ni sporoÄil</div>';
                    return;
                }
                
                container.innerHTML = messages.map(msg => `
                    <div style="margin: 5px 0; padding: 8px; background: ${msg.from === 'admin' ? '#e3f2fd' : '#fff3e0'}; border-radius: 5px; border-left: 3px solid ${msg.from === 'admin' ? '#2196f3' : '#ff9800'};">
                        <div style="font-size: 11px; color: #666; margin-bottom: 3px;">
                            <strong>${msg.from === 'admin' ? 'ð¨âð¼ Admin' : 'ð¤ Stranka'}</strong> - ${new Date(msg.createdAt).toLocaleString('sl-SI')}
                        </div>
                        <div style="font-size: 13px;">${msg.message}</div>
                    </div>
                `).join('');
                
                // Scroll vers le bas pour voir le dernier message
                container.scrollTop = container.scrollHeight;
                
            } catch (error) {
                console.error('Erreur chargement messages admin:', error);
            }
        }

        // Fonction pour afficher/masquer les messages
        function toggleMessages(applicationId) {
            const container = document.getElementById(`adminMessages-${applicationId}`);
            if (container.style.display === 'none') {
                container.style.display = 'block';
                loadAdminMessages(applicationId); // Recharger les messages
            } else {
                container.style.display = 'none';
            }
        }

        // Auto-actualisation pour l'admin (toutes les 10 secondes)
        let adminAutoRefresh = null;

        function startAdminAutoRefresh() {
            if (adminAutoRefresh) {
                clearInterval(adminAutoRefresh);
            }
            
            adminAutoRefresh = setInterval(async () => {
                if (document.getElementById('admin-panel').classList.contains('active')) {
                    try {
                        const applications = await apiCall('/admin/applications');
                        // Recharger seulement les messages, pas toute la liste
                        applications.forEach(app => {
                            loadAdminMessages(app.applicationId);
                        });
                    } catch (error) {
                        console.error('Erreur auto-refresh admin:', error);
                    }
                }
            }, 10000); // Toutes les 10 secondes
        }

        function stopAdminAutoRefresh() {
            if (adminAutoRefresh) {
                clearInterval(adminAutoRefresh);
                adminAutoRefresh = null;
            }
        }

        // Fonction de dÃ©connexion administrateur
        function logoutAdmin() {
            // ArrÃªter l'auto-refresh
            stopAdminAutoRefresh();
            
            // Nettoyer les donnÃ©es
            currentUser = null;
            
            // Vider le champ de recherche
            document.getElementById('trackingNumber').value = '';
            
            // Retourner Ã  l'accueil
            showSection('home');
            
            // Notification
            showNotification('ð¨âð¼ UspeÅ¡na odjava administratorja', 'success', 3000);
        }

        // Fonction de dÃ©connexion utilisateur
        function logoutUser() {
            // Nettoyer les donnÃ©es utilisateur
            currentUser = null;
            
            // Masquer le dashboard
            document.getElementById('userDashboard').classList.add('hidden');
            
            // Vider le champ de recherche
            document.getElementById('trackingNumber').value = '';
            
            // Retourner Ã  l'accueil
            showSection('home');
            
            // Notification
            showNotification('ð¤ UspeÅ¡na odjava uporabnika', 'success', 3000);
        }

        // Fonction pour nettoyer lors du changement de section
        function clearUserSession() {
            currentUser = null;
            document.getElementById('userDashboard').classList.add('hidden');
            document.getElementById('trackingNumber').value = '';
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            loadTestimonials();
            
            // Drag and drop pour les fichiers
            const fileInput = document.querySelector('.file-input');
            
            fileInput.addEventListener('dragover', function(e) {
                e.preventDefault();
                fileInput.classList.add('dragover');
            });
            
            fileInput.addEventListener('dragleave', function() {
                fileInput.classList.remove('dragover');
            });
            
            fileInput.addEventListener('drop', function(e) {
                e.preventDefault();
                fileInput.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    document.getElementById('idDocument').files = files;
                    showNotification('Datoteka naloÅ¾ena: ' + files[0].name);
                }
            });

            // Gestion du changement de fichier
            document.getElementById('idDocument').addEventListener('change', function() {
                if (this.files.length > 0) {
                    showNotification('Datoteka naloÅ¾ena: ' + this.files[0].name);
                }
            });
        });

        // Navigation
        function showSection(sectionId) {
            // ArrÃªter l'auto-refresh quand on quitte l'admin
            if (sectionId !== 'admin-panel') {
                stopAdminAutoRefresh();
            }
            
            // Nettoyer la session utilisateur quand on change de section
            if (sectionId === 'home') {
                clearUserSession();
            }
            
            document.querySelectorAll('.content, .form-section, .tracking-section, .admin-panel').forEach(el => {
                el.classList.remove('active');
                el.style.display = 'none';
            });
            
            document.getElementById(sectionId).classList.add('active');
         document.getElementById(sectionId).style.display = 'block';
            // Traduire la nouvelle section
setTimeout(translatePage, 50);
        }

        // Calculateur de crÃ©dit
        function calculateLoan() {
            const amount = parseFloat(document.getElementById('amount').value);
            const months = parseInt(document.getElementById('months').value);
            
            if (amount && months) {
                const rate = 0.03; // 3% annuel
                const monthlyRate = rate / 12;
                const monthlyPayment = amount * (monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
                const total = monthlyPayment * months;
                const interest = total - amount;
                
                document.getElementById('simulatorResult').innerHTML = `
                    <div>MeseÄna rata: <strong>${monthlyPayment.toFixed(2)}â¬</strong></div>
                    <div>Skupaj vrnete: <strong>${total.toFixed(2)}â¬</strong></div>
                    <div>Skupne obresti: <strong>${interest.toFixed(2)}â¬</strong></div>
                `;
            }
        }

        // TÃ©moignages
        function loadTestimonials() {
            const container = document.getElementById('testimonialsContainer');
            container.innerHTML = testimonials.map(testimonial => `
                <div class="testimonial">
                    <div class="testimonial-author">${testimonial.name}</div>
                    <div class="testimonial-date">${testimonial.date}</div>
                    <div class="testimonial-text">${testimonial.text}</div>
                </div>
            `).join('');
        }

        // Notifications
        function showNotification(message, type = 'success', duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.backgroundColor = type === 'error' ? '#ef4444' : '#10b981';
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, duration);
        }

       // Initialisation par dÃ©faut
showSection('home');
setTimeout(initializeLanguage, 100);
        // SystÃ¨me de traduction simplifiÃ©
let currentLanguage = 'sl';

// Traductions pour 3 langues
const translations = {
    sl: {
        appTitle: "Srce Socialnih Financ",
        tagline: "VaÅ¡ zanesljiv partner za finanÄne reÅ¡itve",
        creditRequest: "Zahteva za kredit",
        creditRequestDesc: "VloÅ¾ite vaÅ¡o kreditno vlogo",
        trackingApplication: "Spremljanje vloge",
        trackingApplicationDesc: "Preverite status vaÅ¡e vloge",
        testimonials: "PriÄevanja",
        testimonialsDesc: "IzkuÅ¡nje naÅ¡ih strank",
        back: "â Nazaj",
        firstName: "Ime *",
        lastName: "Priimek *",
        email: "E-poÅ¡ta *",
        country: "DrÅ¾ava *",
        city: "Mesto *",
        address: "Polni naslov *",
        amount: "Znesek kredita (â¬) *",
        months: "Meseci vraÄanja (1-120) *",
        income: "MeseÄni dohodek (â¬) *",
        submitApplication: "PoÅ¡ljite vlogo",
        trackingNumber: "Vnesite Å¡tevilko sledenja",
        checkStatus: "Preveri status",
        logout: "ðª Odjava",
        sendMessage: "PoÅ¡lji sporoÄilo",
        approve: "Odobri",
        reject: "Zavrni",
        adminPanel: "Administratorski panel"
    },
    
    es: {
        appTitle: "CorazÃ³n de Finanzas Sociales",
        tagline: "Su socio confiable para soluciones financieras",
        creditRequest: "Solicitud de crÃ©dito",
        creditRequestDesc: "EnvÃ­e su solicitud de crÃ©dito",
        trackingApplication: "Seguimiento de solicitud",
        trackingApplicationDesc: "Verifique el estado de su solicitud",
        testimonials: "Testimonios",
        testimonialsDesc: "Experiencias de nuestros clientes",
        back: "â AtrÃ¡s",
        firstName: "Nombre *",
        lastName: "Apellido *",
        email: "Correo electrÃ³nico *",
        country: "PaÃ­s *",
        city: "Ciudad *",
        address: "DirecciÃ³n completa *",
        amount: "Monto del crÃ©dito (â¬) *",
        months: "Meses de reembolso (1-120) *",
        income: "Ingresos mensuales (â¬) *",
        submitApplication: "Enviar solicitud",
        trackingNumber: "Ingrese nÃºmero de seguimiento",
        checkStatus: "Verificar estado",
        logout: "ðª Cerrar sesiÃ³n",
        sendMessage: "Enviar mensaje",
        approve: "Aprobar",
        reject: "Rechazar",
        adminPanel: "Panel de administrador"
        simulator: "Simulador de crÃ©dito (tasa 3%)",
simulatorPlaceholder: "Ingrese monto y meses para el cÃ¡lculo",
document: "Documento de identidad",
documentUpload: "ð Haga clic para elegir archivo",
documentType: "PDF o imagen",
monthlyPayment: "Cuota mensual:",
totalReturn: "Total a devolver:",
totalInterest: "Intereses totales:",
selectCountry: "Seleccione paÃ­s",
slovenia: "Eslovenia",
croatia: "Croacia",
austria: "Austria",
italy: "Italia"
    },
    
    hr: {
        appTitle: "Srce Socijalnih Financija",
        tagline: "VaÅ¡ pouzdani partner za financijska rjeÅ¡enja",
        creditRequest: "Zahtjev za kredit",
        creditRequestDesc: "PoÅ¡aljite svoj zahtjev za kredit",
        trackingApplication: "PraÄenje zahtjeva",
        trackingApplicationDesc: "Provjerite status vaÅ¡eg zahtjeva",
        testimonials: "SvjedoÄanstva",
        testimonialsDesc: "Iskustva naÅ¡ih klijenata",
        back: "â Natrag",
        firstName: "Ime *",
        lastName: "Prezime *",
        email: "E-poÅ¡ta *",
        country: "Zemlja *",
        city: "Grad *",
        address: "Puna adresa *",
        amount: "Iznos kredita (â¬) *",
        months: "Mjeseci otplate (1-120) *",
        income: "MjeseÄni prihod (â¬) *",
        submitApplication: "PoÅ¡aljite zahtjev",
        trackingNumber: "Unesite broj praÄenja",
        checkStatus: "Provjeri status",
        logout: "ðª Odjava",
        sendMessage: "PoÅ¡aljite poruku",
        approve: "Odobri",
        reject: "Odbaci",
        adminPanel: "Administratorski panel"
        simulator: "Simulator kredita (kamata 3%)",
simulatorPlaceholder: "Unesite iznos i mjesece za izraÄun",
document: "Osobni dokument",
documentUpload: "ð Kliknite za odabir datoteke",
documentType: "PDF ili slika",
monthlyPayment: "MjeseÄna rata:",
totalReturn: "Ukupno za vratiti:",
totalInterest: "Ukupne kamate:",
selectCountry: "Odaberite zemlju",
slovenia: "Slovenija",
croatia: "Hrvatska",
austria: "Austrija",
italy: "Italija"
    }
};

// Fonction de traduction
function t(key) {
    return translations[currentLanguage] && translations[currentLanguage][key] 
        ? translations[currentLanguage][key] 
        : translations['sl'][key] || key;
}

// DÃ©tection automatique de la langue du navigateur
function detectBrowserLanguage() {
    const supportedLanguages = {
        'sl': ['sl', 'sl-SI'],
        'es': ['es', 'es-ES', 'es-MX', 'es-AR'],
        'hr': ['hr', 'hr-HR']
    };
    
    const browserLanguages = navigator.languages || [navigator.language || navigator.userLanguage || 'sl'];
    
    for (const browserLang of browserLanguages) {
        const cleanLang = browserLang.toLowerCase();
        for (const [supportedCode, variants] of Object.entries(supportedLanguages)) {
            if (variants.some(variant => cleanLang.startsWith(variant.split('-')[0]))) {
                return supportedCode;
            }
        }
    }
    
    return 'sl';
}

// Fonctions du sÃ©lecteur
function toggleLanguageDropdown() {
    const dropdown = document.getElementById('languageDropdown');
    dropdown.classList.toggle('active');
}

// Fermer le dropdown si on clique ailleurs
document.addEventListener('click', function(event) {
    const dropdown = document.getElementById('languageDropdown');
    if (dropdown && !dropdown.contains(event.target)) {
        dropdown.classList.remove('active');
    }
});

function changeLanguage(langCode) {
    const languages = {
        'sl': { flag: 'ð¸ð®', name: 'SlovenÅ¡Äina' },
        'es': { flag: 'ðªð¸', name: 'EspaÃ±ol' },
        'hr': { flag: 'ð­ð·', name: 'Hrvatski' }
    };
    
    if (languages[langCode]) {
        currentLanguage = langCode;
        
        document.getElementById('currentFlag').textContent = languages[langCode].flag;
        document.getElementById('currentLang').textContent = languages[langCode].name;
        
        document.querySelectorAll('.language-option').forEach(option => {
            option.classList.remove('active');
        });
        event.target.closest('.language-option').classList.add('active');
        
        localStorage.setItem('selectedLanguage', langCode);
        document.getElementById('languageDropdown').classList.remove('active');
        
        translatePage();
        showNotification(`Jezik promijenjen na ${languages[langCode].name}`, 'success', 2000);
    }
}
function translatePage() {
    // Traduire le titre de l'application
    const appTitle = document.querySelector('.app-title');
    if (appTitle) appTitle.textContent = t('appTitle');
    
    // Traduire la tagline
    const taglineElements = document.querySelectorAll('div[style*="font-size: 14px"]');
    taglineElements.forEach(el => {
        if (el.textContent.includes('partner') || el.textContent.includes('zanesljiv') || el.textContent.includes('socio') || el.textContent.includes('pouzdani')) {
            el.textContent = t('tagline');
        }
    });
    
    // Traduire les boutons principaux
    const optionCards = document.querySelectorAll('.option-card');
    if (optionCards[0]) {
        optionCards[0].innerHTML = `
            ð ${t('creditRequest')}
            <div style="font-size: 12px; margin-top: 5px;">${t('creditRequestDesc')}</div>
        `;
    }
    if (optionCards[1]) {
        optionCards[1].innerHTML = `
            ð ${t('trackingApplication')}
            <div style="font-size: 12px; margin-top: 5px;">${t('trackingApplicationDesc')}</div>
        `;
    }
    if (optionCards[2]) {
        optionCards[2].innerHTML = `
            â­ ${t('testimonials')}
            <div style="font-size: 12px; margin-top: 5px;">${t('testimonialsDesc')}</div>
        `;
    }
    
    // Traduire les labels du formulaire
    const labels = document.querySelectorAll('label');
    labels.forEach(label => {
        const text = label.textContent.trim();
        
        // Correspondances pour les labels
        if (text.includes('Ime') || text.includes('Nombre') || text.includes('Ime')) {
            label.textContent = t('firstName');
        } else if (text.includes('Priimek') || text.includes('Apellido') || text.includes('Prezime')) {
            label.textContent = t('lastName');
        } else if (text.includes('E-poÅ¡ta') || text.includes('Correo') || text.includes('E-mail')) {
            label.textContent = t('email');
        } else if (text.includes('DrÅ¾ava') || text.includes('PaÃ­s') || text.includes('Zemlja')) {
            label.textContent = t('country');
        } else if (text.includes('Mesto') || text.includes('Ciudad') || text.includes('Grad')) {
            label.textContent = t('city');
        } else if (text.includes('naslov') || text.includes('DirecciÃ³n') || text.includes('adresa')) {
            label.textContent = t('address');
        } else if (text.includes('Znesek') || text.includes('Monto') || text.includes('Iznos')) {
            label.textContent = t('amount');
        } else if (text.includes('Meseci') || text.includes('Meses') || text.includes('Mjeseci')) {
            label.textContent = t('months');
        } else if (text.includes('dohodek') || text.includes('Ingresos') || text.includes('prihod')) {
            label.textContent = t('income');
        } else if (text.includes('Å¡tevilko') || text.includes('nÃºmero') || text.includes('broj')) {
            label.textContent = t('trackingNumber');
        }
    });
    
    // Traduire les boutons
    const buttons = document.querySelectorAll('button');
    buttons.forEach(button => {
        const text = button.textContent.trim();
        
        if (text.includes('Nazaj') || text.includes('AtrÃ¡s') || text.includes('Natrag')) {
            button.textContent = t('back');
        } else if (text.includes('PoÅ¡ljite vlogo') || text.includes('Enviar solicitud') || text.includes('PoÅ¡aljite zahtjev')) {
            button.textContent = t('submitApplication');
        } else if (text.includes('Preveri status') || text.includes('Verificar estado') || text.includes('Provjeri status')) {
            button.textContent = t('checkStatus');
        } else if (text.includes('Odjava') || text.includes('Cerrar sesiÃ³n')) {
            button.innerHTML = t('logout');
        } else if (text.includes('PoÅ¡lji sporoÄilo') || text.includes('Enviar mensaje') || text.includes('PoÅ¡aljite poruku')) {
            button.textContent = t('sendMessage');
        } else if (text === 'Odobri' || text === 'Aprobar' || text === 'Odobri') {
            button.textContent = t('approve');
        } else if (text === 'Zavrni' || text === 'Rechazar' || text === 'Odbaci') {
            button.textContent = t('reject');
        }
    });
    
    // Traduire les titres de sections
    const headings = document.querySelectorAll('h2, h3, h4');
    headings.forEach(heading => {
        const text = heading.textContent.trim();
        
        if (text.includes('Zahteva za kredit') || text.includes('Solicitud de crÃ©dito') || text.includes('Zahtjev za kredit')) {
            heading.textContent = t('creditRequest');
        } else if (text.includes('Spremljanje vloge') || text.includes('Seguimiento') || text.includes('PraÄenje zahtjeva')) {
            heading.textContent = t('trackingApplication');
        } else if (text.includes('PriÄevanja') || text.includes('Testimonios') || text.includes('SvjedoÄanstva')) {
            heading.textContent = t('testimonials');
        } else if (text.includes('Administratorski panel') || text.includes('Panel de administrador')) {
            heading.textContent = t('adminPanel');
        }
    });
    
    // Traduire les placeholders
    const inputs = document.querySelectorAll('input[placeholder], textarea[placeholder]');
    inputs.forEach(input => {
        const placeholder = input.placeholder;
        if (placeholder.includes('sporoÄilo') || placeholder.includes('mensaje') || placeholder.includes('poruku')) {
            input.placeholder = t('writeMessage');
        }
    });
}
function initializeLanguage() {
    const savedLanguage = localStorage.getItem('selectedLanguage');
    const detectedLanguage = savedLanguage || detectBrowserLanguage();
    
    if (detectedLanguage !== currentLanguage) {
        const languages = {
            'sl': { flag: 'ð¸ð®', name: 'SlovenÅ¡Äina' },
            'es': { flag: 'ðªð¸', name: 'EspaÃ±ol' },
            'hr': { flag: 'ð­ð·', name: 'Hrvatski' }
        };
        
        currentLanguage = detectedLanguage;
        
        if (languages[detectedLanguage]) {
            document.getElementById('currentFlag').textContent = languages[detectedLanguage].flag;
            document.getElementById('currentLang').textContent = languages[detectedLanguage].name;
        }
        
        translatePage();
    }
}
    </script>
</body>
</html>
